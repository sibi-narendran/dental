{% extends "base.html" %}

{% block title %}Doctor Portal{% endblock %}

{% block content %}
<!-- Chat Interface at the top -->
<div class="mb-4">
    <div class="command-sections mb-4">
        <div class="d-flex align-items-center mb-4">
            <h2 class="h3 mb-0">
                <i class="bi bi-robot text-primary me-2"></i>You can ask your AI anything about:
            </h2>
        </div>
        
        <!-- Patient Management Section -->
        <div class="accordion mb-3">
            <div class="accordion-item bg-dark border-0">
                <h3 class="accordion-header">
                    <button class="accordion-button bg-gradient collapsed" data-bs-toggle="collapse" data-bs-target="#patientCommands">
                        <i class="bi bi-person-lines-fill text-info me-2"></i>
                        Patient Management
                    </button>
                </h3>
                <div id="patientCommands" class="accordion-collapse collapse">
                    <div class="accordion-body">
                        <ul class="list-unstyled mb-0">
                            <li class="mb-2"><i class="bi bi-arrow-right-short me-2"></i>"Show me the patient's history."</li>
                            <li class="mb-2"><i class="bi bi-arrow-right-short me-2"></i>"Summarize the patient's x-ray report."</li>
                            <li class="mb-2"><i class="bi bi-arrow-right-short me-2"></i>"Generate a prescription for this patient."</li>
                            <li class="mb-2"><i class="bi bi-arrow-right-short me-2"></i>"Update [patient's name]'s medical record with new notes."</li>
                            <li class="mb-2"><i class="bi bi-arrow-right-short me-2"></i>"What treatments has [patient's name] received before?"</li>
                            <li class="mb-2"><i class="bi bi-arrow-right-short me-2"></i>"Analyze [patient's name]'s documents and tell me any major concerns."</li>
                            <li class="mb-2"><i class="bi bi-arrow-right-short me-2"></i>"Does [patient's name] have any allergies?"</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <!-- Appointment Management Section -->
        <div class="accordion mb-3">
            <div class="accordion-item bg-dark border-0">
                <h3 class="accordion-header">
                    <button class="accordion-button bg-gradient collapsed" data-bs-toggle="collapse" data-bs-target="#appointmentCommands">
                        <i class="bi bi-calendar2-check text-success me-2"></i>
                        Appointment Management
                    </button>
                </h3>
                <div id="appointmentCommands" class="accordion-collapse collapse">
                    <div class="accordion-body">
                        <ul class="list-unstyled mb-0">
                            <li class="mb-2"><i class="bi bi-arrow-right-short me-2"></i>"Reschedule [patient's name]'s appointment to next Monday."</li>
                            <li class="mb-2"><i class="bi bi-arrow-right-short me-2"></i>"Cancel my appointments for tomorrow."</li>
                            <li class="mb-2"><i class="bi bi-arrow-right-short me-2"></i>"Remind [patient's name] about their appointment tomorrow."</li>
                            <li class="mb-2"><i class="bi bi-arrow-right-short me-2"></i>"Check the availability of [date/time]."</li>
                            <li class="mb-2"><i class="bi bi-arrow-right-short me-2"></i>"Book an appointment for [patient's name] next week."</li>
                            <li class="mb-2"><i class="bi bi-arrow-right-short me-2"></i>"Show me my appointments for today."</li>
                            <li class="mb-2"><i class="bi bi-arrow-right-short me-2"></i>"Notify me if there are any cancellations for the week."</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <!-- Communication & Follow-Ups Section -->
        <div class="accordion mb-3">
            <div class="accordion-item bg-dark border-0">
                <h3 class="accordion-header">
                    <button class="accordion-button bg-gradient collapsed" data-bs-toggle="collapse" data-bs-target="#communicationCommands">
                        <i class="bi bi-chat-dots-fill text-warning me-2"></i>
                        Communication & Follow-Ups
                    </button>
                </h3>
                <div id="communicationCommands" class="accordion-collapse collapse">
                    <div class="accordion-body">
                        <ul class="list-unstyled mb-0">
                            <li class="mb-2"><i class="bi bi-arrow-right-short me-2"></i>"Send a follow-up reminder to [patient's name] about their treatment."</li>
                            <li class="mb-2"><i class="bi bi-arrow-right-short me-2"></i>"Send a motivational message to [patient's name] to avoid cool drinks after root canal."</li>
                            <li class="mb-2"><i class="bi bi-arrow-right-short me-2"></i>"Reply to [patient's name] on WhatsApp with their next appointment details."</li>
                            <li class="mb-2"><i class="bi bi-arrow-right-short me-2"></i>"Send a post-treatment care message to [patient's name]."</li>
                            <li class="mb-2"><i class="bi bi-arrow-right-short me-2"></i>"Remind [patient's name] to come for their follow-up visit."</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <!-- Upselling and Customer Engagement Section -->
        <div class="accordion mb-3">
            <div class="accordion-item bg-dark border-0">
                <h3 class="accordion-header">
                    <button class="accordion-button bg-gradient collapsed" data-bs-toggle="collapse" data-bs-target="#upsellingCommands">
                        <i class="bi bi-graph-up-arrow text-info me-2"></i>
                        Upselling and Customer Engagement
                    </button>
                </h3>
                <div id="upsellingCommands" class="accordion-collapse collapse">
                    <div class="accordion-body">
                        <ul class="list-unstyled mb-0">
                            <li class="mb-2"><i class="bi bi-arrow-right-short me-2"></i>"Suggest follow-up treatments for [patient's name]."</li>
                            <li class="mb-2"><i class="bi bi-arrow-right-short me-2"></i>"Send promotional offers on teeth cleaning to my patients."</li>
                            <li class="mb-2"><i class="bi bi-arrow-right-short me-2"></i>"Upsell [patient's name] about teeth whitening services."</li>
                            <li class="mb-2"><i class="bi bi-arrow-right-short me-2"></i>"Tell me which patients have shown interest in cosmetic dental procedures."</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <!-- Query Management Section -->
        <div class="accordion mb-3">
            <div class="accordion-item bg-dark border-0">
                <h3 class="accordion-header">
                    <button class="accordion-button bg-gradient collapsed" data-bs-toggle="collapse" data-bs-target="#queryCommands">
                        <i class="bi bi-question-circle-fill text-warning me-2"></i>
                        Query Management
                    </button>
                </h3>
                <div id="queryCommands" class="accordion-collapse collapse">
                    <div class="accordion-body">
                        <ul class="list-unstyled mb-0">
                            <li class="mb-2"><i class="bi bi-arrow-right-short me-2"></i>"Answer common pre-treatment questions from patients."</li>
                            <li class="mb-2"><i class="bi bi-arrow-right-short me-2"></i>"Handle post-treatment queries from [patient's name]."</li>
                            <li class="mb-2"><i class="bi bi-arrow-right-short me-2"></i>"Provide [patient's name] with an estimated cost of their treatment."</li>
                            <li class="mb-2"><i class="bi bi-arrow-right-short me-2"></i>"Give me a list of common concerns patients have after a root canal."</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <!-- Data Analysis & Reports Section -->
        <div class="accordion mb-3">
            <div class="accordion-item bg-dark border-0">
                <h3 class="accordion-header">
                    <button class="accordion-button bg-gradient collapsed" data-bs-toggle="collapse" data-bs-target="#analysisCommands">
                        <i class="bi bi-graph-up text-danger me-2"></i>
                        Data Analysis & Reports
                    </button>
                </h3>
                <div id="analysisCommands" class="accordion-collapse collapse">
                    <div class="accordion-body">
                        <ul class="list-unstyled mb-0">
                            <li class="mb-2"><i class="bi bi-arrow-right-short me-2"></i>"Show me a summary of patient appointments this month."</li>
                            <li class="mb-2"><i class="bi bi-arrow-right-short me-2"></i>"How many patients missed their appointments this week?"</li>
                            <li class="mb-2"><i class="bi bi-arrow-right-short me-2"></i>"What treatments are most popular among my patients?"</li>
                            <li class="mb-2"><i class="bi bi-arrow-right-short me-2"></i>"Provide a report on follow-up appointment compliance."</li>
                            <li class="mb-2"><i class="bi bi-arrow-right-short me-2"></i>"Analyze patient feedback on recent treatments."</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <!-- Integration Requests Section -->
        <div class="accordion mb-3">
            <div class="accordion-item bg-dark border-0">
                <h3 class="accordion-header">
                    <button class="accordion-button bg-gradient collapsed" data-bs-toggle="collapse" data-bs-target="#integrationCommands">
                        <i class="bi bi-box-arrow-in-down text-success me-2"></i>
                        Integration Requests
                    </button>
                </h3>
                <div id="integrationCommands" class="accordion-collapse collapse">
                    <div class="accordion-body">
                        <ul class="list-unstyled mb-0">
                            <li class="mb-2"><i class="bi bi-arrow-right-short me-2"></i>"Send appointment details to [patient's name] on WhatsApp."</li>
                            <li class="mb-2"><i class="bi bi-arrow-right-short me-2"></i>"Integrate today's schedule with my calendar."</li>
                            <li class="mb-2"><i class="bi bi-arrow-right-short me-2"></i>"Sync my WhatsApp messages with patient records."</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <!-- Natural Language Commands Section -->
        <div class="accordion mb-3">
            <div class="accordion-item bg-dark border-0">
                <h3 class="accordion-header">
                    <button class="accordion-button bg-gradient collapsed" data-bs-toggle="collapse" data-bs-target="#nlCommands">
                        <i class="bi bi-chat-square-text-fill text-primary me-2"></i>
                        Natural Language Commands
                    </button>
                </h3>
                <div id="nlCommands" class="accordion-collapse collapse">
                    <div class="accordion-body">
                        <ul class="list-unstyled mb-0">
                            <li class="mb-2"><i class="bi bi-arrow-right-short me-2"></i>"Tell me if any of my patients have urgent needs."</li>
                            <li class="mb-2"><i class="bi bi-arrow-right-short me-2"></i>"Check if [patient's name] has any upcoming appointments."</li>
                            <li class="mb-2"><i class="bi bi-arrow-right-short me-2"></i>"Summarize recent interactions with [patient's name]."</li>
                            <li class="mb-2"><i class="bi bi-arrow-right-short me-2"></i>"Send a thank you message to [patient's name] for visiting today."</li>
                            <li class="mb-2"><i class="bi bi-arrow-right-short me-2"></i>"Automatically reschedule my appointments for tomorrow due to unavailability."</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Chat Button in separate container -->
    <div class="text-center mb-4">
        <button class="btn btn-lg shadow-lg rounded-pill px-5 py-3 btn-gradient hover-lift" id="chatButton">
            <i class="bi bi-robot me-2"></i> Ask AI Assistant
        </button>
    </div>
</div>

<!-- Appointments Table -->
{% include 'includes/_appointments_table.html' %}

<!-- Chat Overlay -->
<div class="chat-overlay shadow-lg" id="chatOverlay">
    <div class="chat-overlay-content">
        <div class="chat-overlay-header border-bottom mb-3 pb-3">
            <h3 class="mb-0">
                <i class="bi bi-robot text-primary me-2"></i>AI Assistant
            </h3>
            <button class="btn btn-outline-light btn-sm rounded-circle" id="minimizeChat">
                <i class="bi bi-x-lg"></i>
            </button>
        </div>
        <div class="chat-overlay-body">
            <div class="chat-overlay-messages" id="chatMessages">
                <!-- Messages will be added here dynamically -->
            </div>
            <form id="chatForm" class="mt-3">
                <div class="input-group">
                    <textarea class="form-control" id="chatInput" rows="2" 
                        placeholder="Ask about patients, treatments, or appointments..."
                        autocomplete="off"></textarea>
                    <button type="submit" class="btn btn-primary">
                        <i class="bi bi-send-fill"></i>
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/doctor_portal.js') }}"></script>
{% endblock %}